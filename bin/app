#!/usr/bin/env nu

def "main prepare" [] {
  let app_public = $"($env.project)/app/public/"

  # 1.
  rsync -a $"($env.project)/workshop/public/" $app_public

  # 2.
  STYLE_MODE=app workshop build

  # 3.
  let css_files = glob $"($env.project)/workshop/dist/_astro/index.*.css"
  cp ...$css_files $app_public
}

def "main format" [] {
  cd $"($env.project)/app"; elm-format "src/elm" --yes
}

def "main dev" [] {
  cd $"($env.project)/app"; pnpm dev
}

def "main build" [] {
  cd $"($env.project)/app"; pnpm build
}

def "main preview" [] {
  cd $"($env.project)/app"; pnpm preview
}

def main [] {}
